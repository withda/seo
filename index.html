static createSEOPrompt(articleTitle) {
    return `ë‹¹ì‹ ì€ êµ¬ê¸€ SEO ì „ë¬¸ê°€ì´ì í•œêµ­ì˜ ì¸ê¸° ë¸”ë¡œê±°ì…ë‹ˆë‹¤. Rank Math SEO í”ŒëŸ¬ê·¸ì¸ì—ì„œ 100ì ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ì™„ë²½í•œ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”.

âš ï¸ ì¤‘ìš”: í‚¤ì›Œë“œ ìŠ¤í„°í•‘ì€ ì ˆëŒ€ ê¸ˆì§€ì…ë‹ˆë‹¤. ìì—°ìŠ¤ëŸ¬ìš´ ê¸€ì“°ê¸°ê°€ ìµœìš°ì„ ì…ë‹ˆë‹¤.

ì‘ë‹µì„ JSON ê°ì²´ë¡œë§Œ ë°˜í™˜í•˜ì„¸ìš” (title, meta_description, content, keywords, tags).

## í‚¤ì›Œë“œ ì‚¬ìš© ê·œì¹™ (ë§¤ìš° ì¤‘ìš”)

### ë©”ì¸ í‚¤ì›Œë“œ ì‚¬ìš© ì œí•œ
- ì „ì²´ ê¸€ì—ì„œ ë©”ì¸ í‚¤ì›Œë“œëŠ” ìµœëŒ€ 3-5íšŒë§Œ ì‚¬ìš©
- í‚¤ì›Œë“œ ë°€ë„ 1.5% ì´í•˜ ì—„ê²© ì¤€ìˆ˜
- ê°™ì€ í‚¤ì›Œë“œ ë°˜ë³µ ì‚¬ìš© ì ˆëŒ€ ê¸ˆì§€
- ë™ì˜ì–´, ìœ ì‚¬ì–´, ëŒ€ì²´ í‘œí˜„ì„ ë‹¤ì–‘í•˜ê²Œ í™œìš©

### ìì—°ìŠ¤ëŸ¬ìš´ í‚¤ì›Œë“œ ë°°ì¹˜
- ì œëª©ì— 1íšŒ
- ì²« ë¬¸ë‹¨ì— 1íšŒ
- H2 ì†Œì œëª© ì¤‘ 1-2ê°œì—ë§Œ í¬í•¨
- ë§ˆì§€ë§‰ ë¬¸ë‹¨ì— 1íšŒ
- ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ ë™ì˜ì–´ë‚˜ ê´€ë ¨ ìš©ì–´ë¡œ ëŒ€ì²´

### ê¸€ ë¶„ëŸ‰ ìš”êµ¬ì‚¬í•­
- ìµœì†Œ 8,000ì ì´ìƒ (HTML íƒœê·¸ ì œì™¸)
- ì¶©ë¶„í•œ ë¶„ëŸ‰ìœ¼ë¡œ í‚¤ì›Œë“œ ë°€ë„ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ í¬ì„
- ê° H2 ì„¹ì…˜ë§ˆë‹¤ ìµœì†Œ 800-1,200ì

### ì¶œë ¥ êµ¬ì¡°
1. title: ë©”ì¸ í‚¤ì›Œë“œ 1íšŒë§Œ í¬í•¨, 60ì ì´ë‚´ SEO ì œëª©
2. meta_description: ë©”ì¸ í‚¤ì›Œë“œ 1íšŒë§Œ í¬í•¨, 150ì ì´ë‚´ ë©”íƒ€ ì„¤ëª…
3. content: ìœ„ ëª¨ë“  ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ìµœì†Œ 8,000ì ì´ìƒì˜ HTML ì½˜í…ì¸ 
4. keywords: ë©”ì¸ í‚¤ì›Œë“œ í¬í•¨ ë‹¤ì–‘í•œ ê´€ë ¨ í‚¤ì›Œë“œ 5-8ê°œ
5. tags: ë¸”ë¡œê·¸ íƒœê·¸ìš© í‚¤ì›Œë“œ 8-12ê°œ

ê¸°ì‚¬ ì œëª©: ${articleTitle}

í‚¤ì›Œë“œ ìŠ¤í„°í•‘ ì—†ì´ ìì—°ìŠ¤ëŸ½ê³  í’ë¶€í•œ ë‚´ìš©ìœ¼ë¡œ Rank Math SEOì—ì„œ 100ì ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ì™„ë²½í•œ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.`;
  }
  
  static async generateThumbnailText(title, mainKeyword) {
    const prompt = `ë‹¤ìŒ ë¸”ë¡œê·¸ ì œëª©ê³¼ í‚¤ì›Œë“œë¥¼ ë°”íƒ•ìœ¼ë¡œ êµ¬ê¸€ SEOì— ìµœì í™”ëœ ì¸ë„¤ì¼ ë¬¸êµ¬ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.

ë¸”ë¡œê·¸ ì œëª©: ${title}
ë©”ì¸ í‚¤ì›Œë“œ: ${mainKeyword}

ìš”êµ¬ì‚¬í•­:
- 20-40ì ë‚´ì™¸ì˜ ì ë‹¹í•œ ê¸¸ì´
- ë©”ì¸ í‚¤ì›Œë“œë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨
- ê²€ìƒ‰ ì˜ë„ë¥¼ ëª…í™•íˆ ë°˜ì˜
- í´ë¦­ë¥ ì„ ë†’ì´ëŠ” ë§¤ë ¥ì ì¸ í‘œí˜„

3ê°€ì§€ ìŠ¤íƒ€ì¼ë¡œ ìƒì„±:
- ì •ë³´í˜•: êµ¬ì²´ì ì¸ ì •ë³´ë‚˜ ê°€ì´ë“œë¥¼ ì œê³µí•œë‹¤ëŠ” ëŠë‚Œ
- í•´ê²°í˜•: ë¬¸ì œë‚˜ ê¶ê¸ˆì¦ì„ í•´ê²°í•´ì¤€ë‹¤ëŠ” ëŠë‚Œ  
- ì „ë¬¸í˜•: ì „ë¬¸ê°€ì˜ ë¶„ì„ì´ë‚˜ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•œë‹¤ëŠ” ëŠë‚Œ

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ: {"info": "ì •ë³´í˜• ë¬¸êµ¬", "solution": "í•´ê²°í˜• ë¬¸êµ¬", "expert": "ì „ë¬¸í˜• ë¬¸êµ¬"}`;

    try {
      const response = await ApiManager.callOpenAI(prompt, 0.7);
      let thumbnailData = response.choices[0].message.content.trim();
      thumbnailData = thumbnailData.replace(/^```(?:json)?/,'').replace(/```$/,'').trim();
      
      const parsedData = JSON.parse(thumbnailData);
      
      return `
        <div style="text-align: left; line-height: 1.6;">
          <div style="margin-bottom: 0.8rem; padding: 0.5rem; background: rgba(255,255,255,0.8); border-radius: 4px;"><strong>ì •ë³´í˜•:</strong> ${parsedData.info}</div>
          <div style="margin-bottom: 0.8rem; padding: 0.5rem; background: rgba(255,255,255,0.8); border-radius: 4px;"><strong>í•´ê²°í˜•:</strong> ${parsedData.solution}</div>
          <div style="padding: 0.5rem; background: rgba(255,255,255,0.8); border-radius: 4px;"><strong>ì „ë¬¸í˜•:</strong> ${parsedData.expert}</div>
        </div>
      `;
    } catch (error) {
      console.error('Thumbnail text generation failed:', error);
      return 'êµ¬ê¸€ SEO ìµœì í™”ëœ ì™„ë²½ ê°€ì´ë“œ - ì „ë¬¸ê°€ê°€ ì•Œë ¤ì£¼ëŠ” í•µì‹¬ ì „ëµ';
    }
  }
  
  static async generateImagePrompts(content, title, mainKeyword) {
    const headings = content.match(/<h[23][^>]*>(.*?)<\/h[23]>/gi) || [];
    const headingTexts = headings.map(h => h.replace(/<[^>]*>/g, '').trim());
    
    const prompt = `ë‹¤ìŒ ë¸”ë¡œê·¸ ê¸€ì˜ ì†Œì œëª©ë“¤ì„ ë¶„ì„í•˜ì—¬ ê° ì„¹ì…˜ì— ë“¤ì–´ê°ˆ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.

ë¸”ë¡œê·¸ ì œëª©: ${title}
ë©”ì¸ í‚¤ì›Œë“œ: ${mainKeyword}
ì†Œì œëª©ë“¤: ${headingTexts.join(', ')}

ìš”êµ¬ì‚¬í•­:
1. êµ¬ê¸€ ImageFXì— ìµœì í™”ëœ ì˜ë¬¸ í”„ë¡¬í”„íŠ¸
2. ì‚¬ëŒì´ ë‚˜ì˜¤ëŠ” ê²½ìš° ë°˜ë“œì‹œ "Korean person" ë˜ëŠ” "Asian Korean" ëª…ì‹œ
3. ê° ì†Œì œëª©ê³¼ ê´€ë ¨ì„±ì´ ë†’ì€ êµ¬ì²´ì  ì´ë¯¸ì§€

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ: 
{
  "prompts": [
    {
      "heading": "ì†Œì œëª©1",
      "prompt": "ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸1"
    }
  ]
}`;

    try {
      const response = await ApiManager.callOpenAI(prompt, 0.8);
      let promptData = response.choices[0].message.content.trim();
      promptData = promptData.replace(/^```(?:json)?/,'').replace(/```$/,'').trim();
      
      const parsedData = JSON.parse(promptData);
      
      return parsedData.prompts.map((item, index) => 
        `<div style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 8px; border-left: 4px solid #e53e3e;">
          <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
            <span style="background: #e53e3e; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.8rem; margin-right: 0.5rem;">ğŸ“¸ ${index + 1}</span>
            <strong style="color: #d53f8c;">${Utils.sanitizeText(item.heading)}</strong>
          </div>
          <div style="font-family: monospace; font-size: 0.85em; color: #495057; line-height: 1.4; background: rgba(255,255,255,0.7); padding: 0.5rem; border-radius: 4px;">
            ${Utils.sanitizeText(item.prompt)}
          </div>
        </div>`
      ).join('');
    } catch (error) {
      console.error('Image prompt generation failed:', error);
      return '<p style="color: #888;">ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
    }
  }
  
  static async generateImageMetadata(content, title, mainKeyword, keywords) {
    const headings = content.match(/<h[23][^>]*>(.*?)<\/h[23]>/gi) || [];
    const headingTexts = headings.map(h => h.replace(/<[^>]*>/g, '').trim());
    
    const prompt = `ë‹¤ìŒ ë¸”ë¡œê·¸ ê¸€ì˜ ì†Œì œëª©ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ê° ì´ë¯¸ì§€ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.

ë¸”ë¡œê·¸ ì œëª©: ${title}
ë©”ì¸ í‚¤ì›Œë“œ: ${mainKeyword}
ì„œë¸Œ í‚¤ì›Œë“œ: ${keywords.join(', ')}
ì†Œì œëª©ë“¤: ${headingTexts.join(', ')}

ê° ì´ë¯¸ì§€ë§ˆë‹¤ ë‹¤ìŒì„ ìƒì„±:
1. íŒŒì¼ëª… (ì˜ë¬¸, SEO ìµœì í™”, í•˜ì´í”ˆ ì‚¬ìš©)
2. Alt í…ìŠ¤íŠ¸ (ì„œë¸Œí‚¤ì›Œë“œ/ëŒ€ì²´í‚¤ì›Œë“œ í™œìš©, ë©”ì¸í‚¤ì›Œë“œ ê³¼ë‹¤ ì‚¬ìš© ê¸ˆì§€)
3. ìº¡ì…˜ (ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´, ì„œë¸Œí‚¤ì›Œë“œ í¬í•¨)

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ:
{
  "images": [
    {
      "heading": "ì†Œì œëª©1",
      "filename": "íŒŒì¼ëª….jpg",
      "alt": "Alt í…ìŠ¤íŠ¸",
      "caption": "ìº¡ì…˜"
    }
  ]
}`;

    try {
      const response = await ApiManager.callOpenAI(prompt, 0.6);
      let metadataData = response.choices[0].message.content.trim();
      metadataData = metadataData.replace(/^```(?:json)?/,'').replace(/```$/,'').trim();
      
      const parsedData = JSON.parse(metadataData);
      
      return `
        <div style="margin-top: 2rem; padding: 1rem; background: rgba(240,248,255,0.8); border-radius: 8px; border-left: 4px solid #4299e1;">
          <h5 style="color: #2b6cb0; margin-bottom: 1rem; display: flex; align-items: center;">
            <span style="margin-right: 0.5rem;">ğŸ·ï¸</span>ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„° (íŒŒì¼ëª…/Alt/ìº¡ì…˜)
          </h5>
          ${parsedData.images.map((item) => 
            `<div style="margin-bottom: 1.5rem; padding: 0.8rem; background: rgba(255,255,255,0.9); border-radius: 6px; border: 1px solid #e2e8f0;">
              <div style="font-weight: bold; color: #2d3748; margin-bottom: 0.5rem;">${Utils.sanitizeText(item.heading)}</div>
              <div style="margin-bottom: 0.3rem;"><strong>íŒŒì¼ëª…:</strong> <code style="background: #f7fafc; padding: 2px 4px; border-radius: 3px; font-size: 0.85em;">${Utils.sanitizeText(item.filename)}</code></div>
              <div style="margin-bottom: 0.3rem;"><strong>Alt:</strong> <span style="color: #4a5568;">${Utils.sanitizeText(item.alt)}</span></div>
              <div><strong>ìº¡ì…˜:</strong> <span style="color: #4a5568; font-style: italic;">${Utils.sanitizeText(item.caption)}</span></div>
            </div>`
          ).join('')}
        </div>
      `;
    } catch (error) {
      console.error('Image metadata generation failed:', error);
      return '<p style="color: #888;">ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
    }
  }
}

// ë‚´ë³´ë‚´ê¸° ê´€ë¦¬ í´ë˜ìŠ¤
class ExportManager {
  static htmlToMarkdown(html) {
    return html
      .replace(/<h([1-6])>(.*?)<\/h[1-6]>/gi, (match, level, text) => '#'.repeat(parseInt(level)) + ' ' + text + '\n\n')
      .replace(/<p>(.*?)<\/p>/gi, '$1\n\n')
      .replace(/<br\s*\/?>/gi, '\n')
      .replace(/<strong>(.*?)<\/strong>/gi, '**$1**')
      .replace(/<b>(.*?)<\/b>/gi, '**$1**')
      .replace(/<em>(.*?)<\/em>/gi, '*$1*')
      .replace(/<i>(.*?)<\/i>/gi, '*$1*')
      .replace(/<a href="(.*?)".*?>(.*?)<\/a>/gi, '[$2]($1)')
      .replace(/<img[^>]*src="([^"]*)"[^>]*alt="([^"]*)"[^>]*>/gi, '![${2}]($1)')
      .replace(/<img[^>]*src="([^"]*)"[^>]*>/gi, '![]($1)')
      .replace(/<ul>/gi, '').replace(/<\/ul>/gi, '\n')
      .replace(/<ol>/gi, '').replace(/<\/ol>/gi, '\n')
      .replace(/<li>(.*?)<\/li>/gi, '- $1\n')
      .replace(/<[^>]*>/g, '')
      .replace(/\n\s*\n\s*\n/g, '\n\n')
      .trim();
  }
  
  static downloadFile(content, filename, type) {
    try {
      const blob = new Blob([content], { type });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    } catch (error) {
      console.error('File download failed:', error);
      throw new Error('íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  }
  
  static async copyToClipboard(text) {
    try {
      await navigator.clipboard.writeText(text);
      return true;
    } catch (error) {
      try {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        return true;
      } catch (fallbackError) {
        console.error('Clipboard copy failed:', fallbackError);
        return false;
      }
    }
  }
  
  static sanitizeFilename(filename) {
    return filename.replace(/[^a-zA-Z0-9ê°€-í£]/g, '_').substring(0, 100);
  }
}

// ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ í´ë˜ìŠ¤
class App {
  constructor() {
    this.currentPost = null;
    this.searchResults = [];
    this.isGenerating = false;
    this.isSearching = false;
    
    this.initializeEventListeners();
    this.loadStoredKeys();
  }
  
  initializeEventListeners() {
    // API í‚¤ ì €ì¥
    document.getElementById('saveKeysBtn').addEventListener('click', () => this.saveApiKeys());
    
    // ê²€ìƒ‰
    document.getElementById('searchBtn').addEventListener('click', () => this.searchArticles());
    document.getElementById('query').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') this.searchArticles();
    });
    
    // ìƒì„±
    document.getElementById('generateBtn').addEventListener('click', () => this.generateContent());
    
    // ë‚´ë³´ë‚´ê¸°
    document.getElementById('copyHtmlBtn').addEventListener('click', () => this.copyHtml());
    document.getElementById('copyMarkdownBtn').addEventListener('click', () => this.copyMarkdown());
    document.getElementById('downloadHtmlBtn').addEventListener('click', () => this.downloadHtml());
    document.getElementById('downloadMarkdownBtn').addEventListener('click', () => this.downloadMarkdown());
    document.getElementById('captureBtn').addEventListener('click', () => this.captureImage());
  }
  
  loadStoredKeys() {
    const keys = ['openai_key', 'pexels_key'];
    keys.forEach(key => {
      const element = document.getElementById(key);
      const stored = localStorage.getItem(key);
      if (element && stored) {
        element.value = stored;
      }
    });
  }
  
  saveApiKeys() {
    const openaiKey = document.getElementById('openai_key').value.trim();
    const pexelsKey = document.getElementById('pexels_key').value.trim();
    
    let hasError = false;
    
    // OpenAI í‚¤ ê²€ì¦
    if (openaiKey && !Utils.validateOpenAIKey(openaiKey)) {
      Utils.showError('openai_error', 'ì˜¬ë°”ë¥¸ OpenAI API í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (sk-ë¡œ ì‹œì‘í•˜ëŠ” í‚¤)');
      hasError = true;
    }
    
    // Pexels í‚¤ ê²€ì¦
    if (pexelsKey && !Utils.validatePexelsKey(pexelsKey)) {
      Utils.showError('pexels_error', 'Pexels API í‚¤ê°€ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤.');
      hasError = true;
    }
    
    if (hasError) return;
    
    // ì €ì¥
    if (openaiKey) localStorage.setItem('openai_key', openaiKey);
    if (pexelsKey) localStorage.setItem('pexels_key', pexelsKey);
    
    Utils.showSuccess('keys_success', 'API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
  }
  
  async searchArticles() {
    if (this.isSearching) return;
    
    const query = document.getElementById('query').value.trim();
    if (!query) {
      alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    this.isSearching = true;
    Utils.setButtonLoading('searchBtn', true);
    Utils.updateProgress('searchProgress', 10);
    
    try {
      // êµ¬ê¸€ ë‰´ìŠ¤ ê²€ìƒ‰
      Utils.updateProgress('searchProgress', 30);
      const googleResults = await NewsSearcher.searchGoogleNews(query);
      
      // ë„¤ì´ë²„ ë‰´ìŠ¤ ê²€ìƒ‰
      Utils.updateProgress('searchProgress', 60);
      const naverResults = await NewsSearcher.searchNaverNews(query);
      
      // ê²°ê³¼ í•©ì¹˜ê¸° ë° ì¤‘ë³µ ì œê±°
      Utils.updateProgress('searchProgress', 80);
      const allResults = [...googleResults, ...naverResults];
      const uniqueResults = NewsSearcher.removeDuplicates(allResults);
      
      // ì ìˆ˜ ê³„ì‚° ë° ì •ë ¬
      uniqueResults.forEach(item => {
        item.finalScore = NewsSearcher.calculateFinalScore(item, query);
      });
      
      this.searchResults = uniqueResults
        .sort((a, b) => b.finalScore - a.finalScore)
        .slice(0, CONFIG.MAX_ARTICLES);
      
      Utils.updateProgress('searchProgress', 100);
      this.displaySearchResults();
      
    } catch (error) {
      console.error('Search failed:', error);
      alert('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
    } finally {
      this.isSearching = false;
      Utils.setButtonLoading('searchBtn', false);
      Utils.updateProgress('searchProgress', 0);
    }
  }
  
  displaySearchResults() {
    const container = document.getElementById('articles');
    const actionsSection = document.getElementById('actions');
    
    if (!this.searchResults.length) {
      container.innerHTML = '<p style="text-align: center; color: #666; padding: 2rem;">ê´€ë ¨ ê¸°ì‚¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
      actionsSection.classList.add('hidden');
      return;
    }
    
    container.innerHTML = this.searchResults.map((item, index) => {
      const date = new Date(item.pubDate).toISOString().slice(0, 16).replace('T', ' ');
      const sourceIcon = item.source === 'naver' ? 'ğŸ”¥' : 'ğŸ“°';
      
      return `
        <div class="article-item">
          <input type="radio" name="article" id="article_${index}" value="${index}">
          <label for="article_${index}">
            ${sourceIcon} ${index + 1}. ${Utils.sanitizeText(item.title)} [${date}]
          </label>
        </div>
      `;
    }).join('');
    
    actionsSection.classList.remove('hidden');
  }
  
  async generateContent() {
    if (this.isGenerating) return;
    
    const selectedArticle = document.querySelector('input[name="article"]:checked');
    if (!selectedArticle) {
      alert('ê¸°ì‚¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
      return;
    }
    
    const articleIndex = parseInt(selectedArticle.value);
    const article = this.searchResults[articleIndex];
    const query = document.getElementById('query').value.trim();
    
    this.isGenerating = true;
    this.currentPost = null;
    
    Utils.setButtonLoading('generateBtn', true);
    Utils.updateProgress('generateProgress', 5);
    
    const preview = document.getElementById('preview');
    preview.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">ì½˜í…ì¸  ìƒì„± ì¤‘ì…ë‹ˆë‹¤...</div>';
    
    try {
      // 1. ë©”ì¸ ì½˜í…ì¸  ìƒì„±
      Utils.updateProgress('generateProgress', 20);
      const prompt = ContentGenerator.createSEOPrompt(article.title);
      const response = await ApiManager.callOpenAI(prompt, 0.6);
      
      Utils.updateProgress('generateProgress', 40);
      let rawContent = response.choices[0].message.content.trim();
      rawContent = rawContent.replace(/^```(?:json)?/,'').replace(/```$/,'').trim();
      
      const data = JSON.parse(rawContent);
      
      // ë°ì´í„° ê²€ì¦
      if (!data.title || !data.content) {
        throw new Error('í•„ìˆ˜ ë°ì´í„°ê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
      }
      
      // ê¸°ë³¸ê°’ ì„¤ì •
      data.keywords = Array.isArray(data.keywords) ? data.keywords : [data.keywords || query];
      data.tags = Array.isArray(data.tags) ? data.tags : [data.tags || query];
      data.meta_description = data.meta_description || data.content.replace(/<[^>]*>/g, '').slice(0, 150) + '...';
      
      Utils.updateProgress('generateProgress', 60);
      
      // 2. ë³‘ë ¬ë¡œ ì¶”ê°€ ì½˜í…ì¸  ìƒì„±
      const [thumbnailText, imagePrompts, imageMetadata, featuredImage] = await Promise.all([
        ContentGenerator.generateThumbnailText(data.title, query),
        ContentGenerator.generateImagePrompts(data.content, data.title, query),
        ContentGenerator.generateImageMetadata(data.content, data.title, query, data.keywords),
        this.getFeaturedImage(article.title)
      ]);
      
      Utils.updateProgress('generateProgress', 90);
      
      // 3. ê²°ê³¼ ì¡°í•©
      const cleanContent = data.content.replace(/<img[^>]*>/gi, '');
      const imgHtml = featuredImage ? 
        `<img src="${featuredImage}" alt="ëŒ€í‘œ ì´ë¯¸ì§€" style="width: 100%; border-radius: 8px;">` : 
        '<p style="color: gray; text-align: center; padding: 1rem;">ëŒ€í‘œ ì´ë¯¸ì§€ ì—†ìŒ</p>';
      
      // 4. ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
      preview.innerHTML = `
        <h3>${Utils.sanitizeText(data.title)}</h3>
        <p><strong>ë©”íƒ€ ì„¤ëª…:</strong> ${Utils.sanitizeText(data.meta_description)}</p>
        <p><strong>ë©”ì¸í‚¤ì›Œë“œ:</strong> ${Utils.sanitizeText(query)}</p>
        <p><strong>í‚¤ì›Œë“œ:</strong> ${data.keywords.map(k => Utils.sanitizeText(k)).join(', ')}</p>
        
        <div style="margin: 1rem 0; padding: 1rem; background: linear-gradient(135deg, #ff6b6b, #ee5a24); border-radius: 8px; color: white; text-align: center; font-weight: bold; font-size: 1.1rem; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
          ${thumbnailText}
        </div>
        
        <div>${imgHtml}</div>
        <div style="margin-top: 1rem;">${cleanContent}</div>
        
        <div class="content-section">
          <div class="section-title">
            <span>ğŸ¨</span>ì†Œì œëª©ë³„ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ (êµ¬ê¸€ ImageFXìš©)
          </div>
          ${imagePrompts}
          ${imageMetadata}
        </div>
      `;
      
      // 5. í¬ìŠ¤íŠ¸ ë°ì´í„° ì €ì¥
      this.currentPost = {
        title: data.title,
        content: cleanContent,
        tags: data.tags,
        keywords: data.keywords,
        meta_description: data.meta_description,
        mainKeyword: query,
        imgUrl: featuredImage,
        imagePrompts,
        imageMetadata,
        thumbnailText
      };
      
      Utils.updateProgress('generateProgress', 100);
      
      // ë‚´ë³´ë‚´ê¸° ì˜µì…˜ í‘œì‹œ
      document.getElementById('exportOptions').classList.remove('hidden');
      
    } catch (error) {
      console.error('Content generation failed:', error);
      preview.innerHTML = `<p style="color: red; text-align: center; padding: 2rem;">âŒ ${error.message}</p>`;
    } finally {
      this.isGenerating = false;
      Utils.setButtonLoading('generateBtn', false);
      Utils.updateProgress('generateProgress', 0);
    }
  }
  
  async getFeaturedImage(title) {
    try {
      const englishTitle = await ContentGenerator.translateToEnglish(title);
      return await ApiManager.searchPexelsImage(englishTitle);
    } catch (error) {
      console.warn('Featured image search failed:', error);
      return null;
    }
  }
  
  async copyHtml() {
    if (!this.currentPost) {
      alert('ë¨¼ì € ì½˜í…ì¸ ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    const htmlContent = this.buildHtmlContent();
    const success = await ExportManager.copyToClipboard(htmlContent);
    
    if (success) {
      alert('âœ… HTMLì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    } else {
      alert('âŒ í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  }
  
  async copyMarkdown() {
    if (!this.currentPost) {
      alert('ë¨¼ì € ì½˜í…ì¸ ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    const markdownContent = this.buildMarkdownContent();
    const success = await ExportManager.copyToClipboard(markdownContent);
    
    if (success) {
      alert('âœ… Markdownì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    } else {
      alert('âŒ í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  }
  
  downloadHtml() {
    if (!this.currentPost) {
      alert('ë¨¼ì € ì½˜í…ì¸ ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    try {
      const htmlContent = this.buildCompleteHtmlDocument();
      const filename = ExportManager.sanitizeFilename(this.currentPost.title) + '.html';
      ExportManager.downloadFile(htmlContent, filename, 'text/html');
    } catch (error) {
      alert('âŒ HTML íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  }
  
  downloadMarkdown() {
    if (!this.currentPost) {
      alert('ë¨¼ì € ì½˜í…ì¸ ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    try {
      const markdownContent = this.buildMarkdownContent();
      const filename = ExportManager.sanitizeFilename(this.currentPost.title) + '.md';
      ExportManager.downloadFile(markdownContent, filename, 'text/markdown');
    } catch (error) {
      alert('âŒ Markdown íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  }
  
  async captureImage() {
    if (!this.currentPost) {
      alert('ë¨¼ì € ì½˜í…ì¸ ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    try {
      if (!window.html2canvas) {
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
        document.head.appendChild(script);
        await new Promise(resolve => script.onload = resolve);
      }
      
      const preview = document.getElementById('preview');
      const canvas = await html2canvas(preview, {
        backgroundColor: '#ffffff',
        scale: 2,
        useCORS: true
      });
      
      canvas.toBlob(blob => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = ExportManager.sanitizeFilename(this.currentPost.title) + '.png';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Suah AI Auto Posting</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
    
    :root {
      --primary-color: #e53e3e;
      --secondary-color: #d53f8c;
      --accent-color: #fbb6ce;
      --background-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
      --card-background: rgba(255,255,255,0.95);
      --border-radius: 12px;
      --box-shadow: 0 8px 32px rgba(255,182,193,0.3);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
    }
    
    body { 
      font-family: 'Poppins', sans-serif; 
      max-width: 900px; 
      margin: 0 auto; 
      padding: 1rem;
      background: var(--background-gradient);
      min-height: 100vh;
      color: #2d3748;
      line-height: 1.6;
    }
    
    .container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    h1 { 
      text-align: center; 
      color: var(--primary-color);
      font-weight: 700;
      font-size: 2rem;
      text-shadow: 2px 2px 4px rgba(255,255,255,0.8);
      margin-bottom: 1.5rem;
      line-height: 1.2;
    }
    
    h2 {
      color: var(--secondary-color);
      font-weight: 600;
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }
    
    .section { 
      background: var(--card-background);
      backdrop-filter: blur(10px);
      border: none;
      padding: 1.5rem; 
      border-radius: var(--border-radius); 
      box-shadow: var(--box-shadow);
      border: 1px solid rgba(255,255,255,0.2);
      position: relative;
    }
    
    .input-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    
    .input-group:last-child {
      margin-bottom: 0;
    }
    
    .section input[type="text"], 
    .section input[type="password"] {
      width: 100%; 
      padding: 12px 16px;
      border: 2px solid var(--accent-color);
      border-radius: var(--border-radius);
      font-size: 1rem;
      transition: var(--transition);
      background: rgba(255,255,255,0.9);
      font-family: inherit;
    }
    
    .section input[type="text"]:focus, 
    .section input[type="password"]:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(229,62,62,0.1);
      transform: translateY(-1px);
    }
    
    .btn {
      padding: 12px 24px; 
      background: linear-gradient(135deg, var(--primary-color) 0%, #f56565 100%);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      font-size: 1rem;
      width: 100%;
      font-family: inherit;
      position: relative;
      overflow: hidden;
    }
    
    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(229,62,62,0.3);
    }
    
    .btn:active:not(:disabled) {
      transform: translateY(0);
    }
    
    .btn:disabled {
      background: #cbd5e0;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .btn.loading {
      pointer-events: none;
    }
    
    .btn.loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      border: 2px solid transparent;
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      transform: translate(-50%, -50%);
    }
    
    @keyframes spin {
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    .helper { 
      font-size: 0.85rem; 
      color: #718096; 
      line-height: 1.5;
      margin-top: 0.5rem;
    }
    
    .error-message {
      color: #e53e3e;
      font-size: 0.85rem;
      margin-top: 0.5rem;
      padding: 0.5rem;
      background: rgba(229, 62, 62, 0.1);
      border-radius: 4px;
      border-left: 3px solid #e53e3e;
    }
    
    .success-message {
      color: #38a169;
      font-size: 0.85rem;
      margin-top: 0.5rem;
      padding: 0.5rem;
      background: rgba(56, 161, 105, 0.1);
      border-radius: 4px;
      border-left: 3px solid #38a169;
    }
    
    #articles { 
      max-height: 300px; 
      overflow-y: auto; 
      border: 2px solid var(--accent-color); 
      padding: 1rem; 
      font-size: 0.9rem;
      border-radius: var(--border-radius);
      background: rgba(255,255,255,0.8);
    }
    
    .article-item { 
      display: flex; 
      align-items: flex-start; 
      margin-bottom: 0.8rem;
      padding: 8px;
      border-radius: 8px;
      transition: background 0.2s ease;
    }
    
    .article-item:hover {
      background: rgba(255,182,193,0.2);
    }
    
    .article-item input[type="radio"] { 
      margin-right: 0.8rem;
      margin-top: 2px;
      accent-color: var(--primary-color);
      flex-shrink: 0;
    }
    
    .article-item label { 
      flex: 1; 
      cursor: pointer;
      font-weight: 400;
      line-height: 1.4;
      word-break: break-word;
    }
    
    #preview { 
      background: rgba(255,255,255,0.9);
      padding: 1.5rem;
      border-radius: var(--border-radius);
      margin-top: 1rem;
      border: 2px solid var(--accent-color);
      max-height: 500px;
      overflow-y: auto;
      word-break: break-word;
      line-height: 1.8;
    }
    
    #preview img { 
      display: block; 
      width: 100%; 
      height: auto; 
      object-fit: contain; 
      margin: 1rem 0;
      border-radius: var(--border-radius);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    #preview h3 {
      color: var(--secondary-color);
      margin-bottom: 1rem;
      font-weight: 600;
      font-size: 1.3rem;
      line-height: 1.3;
    }
    
    .hidden { 
      display: none !important; 
    }
    
    .export-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.8rem;
      margin: 1rem 0;
    }
    
    .export-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
      font-size: 0.9rem !important;
      padding: 10px 16px !important;
      margin: 0 !important;
    }
    
    .export-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%) !important;
      transform: translateY(-2px);
    }
    
    .progress-bar {
      width: 100%;
      height: 4px;
      background: rgba(255,255,255,0.3);
      border-radius: 2px;
      overflow: hidden;
      margin-top: 1rem;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      width: 0%;
      transition: width 0.3s ease;
    }
    
    .content-section {
      margin: 2rem 0;
      padding: 1.5rem;
      background: rgba(255,255,255,0.9);
      border-radius: var(--border-radius);
      border: 2px solid var(--accent-color);
    }
    
    .section-title {
      color: var(--secondary-color);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .section-title span {
      margin-right: 0.5rem;
    }
    
    /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
    #articles::-webkit-scrollbar, 
    #preview::-webkit-scrollbar {
      width: 6px;
    }
    
    #articles::-webkit-scrollbar-track, 
    #preview::-webkit-scrollbar-track {
      background: rgba(255,182,193,0.2);
      border-radius: 3px;
    }
    
    #articles::-webkit-scrollbar-thumb, 
    #preview::-webkit-scrollbar-thumb {
      background: var(--accent-color);
      border-radius: 3px;
    }
    
    #articles::-webkit-scrollbar-thumb:hover, 
    #preview::-webkit-scrollbar-thumb:hover {
      background: var(--primary-color);
    }

    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ë””ìì¸ */
    @media (max-width: 768px) {
      body {
        padding: 0.5rem;
      }
      
      h1 {
        font-size: 1.8rem;
        margin-bottom: 1rem;
      }
      
      h2 {
        font-size: 1.1rem;
      }
      
      .section {
        padding: 1rem;
      }
      
      .section input[type="text"], 
      .section input[type="password"] {
        padding: 10px 12px;
        font-size: 16px; /* iOS ì¤Œ ë°©ì§€ */
      }
      
      .btn {
        padding: 14px 20px;
        font-size: 1rem;
      }
      
      .helper {
        font-size: 0.8rem;
      }
      
      #articles {
        max-height: 250px;
        padding: 0.8rem;
        font-size: 0.85rem;
      }
      
      .article-item {
        padding: 6px;
        margin-bottom: 0.6rem;
      }
      
      .article-item label {
        font-size: 0.85rem;
      }
      
      #preview {
        padding: 1rem;
        max-height: 400px;
        font-size: 0.9rem;
        line-height: 1.6;
      }
      
      #preview h2, #preview h3, #preview h4 {
        word-break: keep-all;
        word-wrap: break-word;
        line-height: 1.4;
        margin: 1rem 0 0.5rem 0;
      }
      
      #preview p {
        word-break: break-word;
        line-height: 1.6;
        margin-bottom: 1rem;
      }
      
      #preview h3 {
        font-size: 1.1rem;
      }
      
      .export-grid {
        grid-template-columns: 1fr 1fr;
        gap: 0.5rem;
      }
      
      .content-section {
        padding: 1rem;
        margin: 1rem 0;
      }
      
      /* ìŠ¤í¬ë¡¤ë°” ëª¨ë°”ì¼ì—ì„œ ë” ì–‡ê²Œ */
      #articles::-webkit-scrollbar, 
      #preview::-webkit-scrollbar {
        width: 4px;
      }
    }

    /* ì•„ì£¼ ì‘ì€ í™”ë©´ (380px ì´í•˜) */
    @media (max-width: 380px) {
      body {
        padding: 0.3rem;
      }
      
      h1 {
        font-size: 1.5rem;
      }
      
      .section {
        padding: 0.8rem;
      }
      
      .section input[type="text"], 
      .section input[type="password"] {
        padding: 8px 10px;
      }
      
      #articles {
        max-height: 200px;
        padding: 0.6rem;
      }
      
      #preview {
        padding: 0.8rem;
        max-height: 350px;
      }
      
      .export-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Suah AI Auto Posting</h1>

    <div class="section">
      <h2>API Keys ì„¤ì •</h2>
      <div class="input-group">
        <input type="password" id="openai_key" placeholder="OpenAI API Key (sk-...)" />
        <div id="openai_error" class="error-message hidden">ì˜¬ë°”ë¥¸ OpenAI API í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.</div>
      </div>
      <div class="input-group">
        <input type="text" id="pexels_key" placeholder="Pexels API Key" />
        <div id="pexels_error" class="error-message hidden">Pexels API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
      </div>
      <button id="saveKeysBtn" class="btn">ì €ì¥</button>
      <div id="keys_success" class="success-message hidden">API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
    </div>

    <div class="section">
      <h2>ê¸°ì‚¬ ê²€ìƒ‰</h2>
      <div class="input-group">
        <input type="text" id="query" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" />
        <div class="helper">ì˜ˆ: ì•„ì´í°, ì‚¼ì„±, ì½”ì¸, ì£¼ì‹ ë“±</div>
      </div>
      <button id="searchBtn" class="btn">ê²€ìƒ‰</button>
      <div class="progress-bar hidden" id="searchProgress">
        <div class="progress-fill"></div>
      </div>
      <div id="articles"></div>
    </div>

    <div class="section hidden" id="actions">
      <h2>ìƒì„± & ë¯¸ë¦¬ë³´ê¸°</h2>
      <button id="generateBtn" class="btn">ìƒì„±</button>
      <div class="progress-bar hidden" id="generateProgress">
        <div class="progress-fill"></div>
      </div>
      <div id="preview"></div>
      
      <div id="exportOptions" class="hidden">
        <div class="section-title">
          <span>ğŸ“‹</span>ë‚´ë³´ë‚´ê¸° ì˜µì…˜
        </div>
        <div class="export-grid">
          <button id="copyHtmlBtn" class="btn export-btn">ğŸ“„ HTML ë³µì‚¬</button>
          <button id="copyMarkdownBtn" class="btn export-btn">ğŸ“ Markdown ë³µì‚¬</button>
          <button id="downloadHtmlBtn" class="btn export-btn">ğŸ’¾ HTML ì €ì¥</button>
          <button id="downloadMarkdownBtn" class="btn export-btn">ğŸ’¾ MD ì €ì¥</button>
          <button id="captureBtn" class="btn export-btn">ğŸ“¸ ì´ë¯¸ì§€ ì €ì¥</button>
        </div>
      </div>
    </div>
  </div>

<script>
// ì„¤ì • ë° ìƒìˆ˜
const CONFIG = {
  MAX_ARTICLES: 30,
  MIN_CONTENT_LENGTH: 8000,
  KEYWORD_DENSITY_MAX: 1.5,
  FETCH_TIMEOUT: 15000,
  OPENAI_API_KEY_PATTERN: /^sk-[a-zA-Z0-9]{20,}$/,
  PEXELS_API_KEY_MIN_LENGTH: 10
};

// ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤
class Utils {
  static sanitizeText(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
  
  static validateOpenAIKey(key) {
    return CONFIG.OPENAI_API_KEY_PATTERN.test(key?.trim());
  }
  
  static validatePexelsKey(key) {
    return key?.trim().length >= CONFIG.PEXELS_API_KEY_MIN_LENGTH;
  }
  
  static showError(elementId, message) {
    const element = document.getElementById(elementId);
    if (element) {
      element.textContent = message;
      element.classList.remove('hidden');
      setTimeout(() => element.classList.add('hidden'), 5000);
    }
  }
  
  static showSuccess(elementId, message) {
    const element = document.getElementById(elementId);
    if (element) {
      element.textContent = message;
      element.classList.remove('hidden');
      setTimeout(() => element.classList.add('hidden'), 3000);
    }
  }
  
  static setButtonLoading(buttonId, isLoading) {
    const button = document.getElementById(buttonId);
    if (!button) return;
    
    if (isLoading) {
      button.classList.add('loading');
      button.disabled = true;
    } else {
      button.classList.remove('loading');
      button.disabled = false;
    }
  }
  
  static updateProgress(progressId, percentage) {
    const progressBar = document.getElementById(progressId);
    if (!progressBar) return;
    
    const fill = progressBar.querySelector('.progress-fill');
    if (fill) {
      fill.style.width = `${Math.min(100, Math.max(0, percentage))}%`;
    }
    
    if (percentage === 0) {
      progressBar.classList.add('hidden');
    } else {
      progressBar.classList.remove('hidden');
    }
  }
}

// API ê´€ë¦¬ í´ë˜ìŠ¤
class ApiManager {
  static async fetchWithTimeout(url, options = {}, timeout = CONFIG.FETCH_TIMEOUT) {
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), timeout);
    
    try {
      const response = await fetch(url, {
        ...options,
        signal: controller.signal
      });
      clearTimeout(timeoutId);
      return response;
    } catch (error) {
      clearTimeout(timeoutId);
      throw error;
    }
  }
  
  static async callOpenAI(prompt, temperature = 0.6) {
    const apiKey = localStorage.getItem('openai_key');
    if (!Utils.validateOpenAIKey(apiKey)) {
      throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ OpenAI API í‚¤ì…ë‹ˆë‹¤.');
    }
    
    const response = await this.fetchWithTimeout('https://api.openai.com/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${apiKey}`
      },
      body: JSON.stringify({
        model: 'gpt-4o-mini',
        messages: [{
          role: 'system',
          content: 'ë‹¹ì‹ ì€ í‚¤ì›Œë“œ ìŠ¤í„°í•‘ì„ ì ˆëŒ€ í•˜ì§€ ì•ŠëŠ” ì „ë¬¸ SEO ë¼ì´í„°ì…ë‹ˆë‹¤. ìì—°ìŠ¤ëŸ¬ìš´ ê¸€ì“°ê¸°ë¡œ ê³ í’ˆì§ˆ ì½˜í…ì¸ ë¥¼ ë§Œë“¤ì–´ JSONë§Œ ë°˜í™˜í•˜ì„¸ìš”.'
        }, {
          role: 'user',
          content: prompt
        }],
        temperature,
        max_tokens: 4000
      })
    });
    
    if (!response.ok) {
      throw new Error(`OpenAI API ì˜¤ë¥˜: ${response.status}`);
    }
    
    return response.json();
  }
  
  static async searchPexelsImage(query) {
    const apiKey = localStorage.getItem('pexels_key');
    if (!Utils.validatePexelsKey(apiKey)) {
      return null;
    }
    
    try {
      const response = await this.fetchWithTimeout(
        `https://api.pexels.com/v1/search?query=${encodeURIComponent(query)}&orientation=landscape&per_page=1`,
        {
          headers: { Authorization: apiKey }
        }
      );
      
      if (!response.ok) return null;
      
      const data = await response.json();
      return data.photos?.[0]?.src?.large2x || null;
    } catch (error) {
      console.warn('Pexels search failed:', error);
      return null;
    }
  }
}

// ë‰´ìŠ¤ ê²€ìƒ‰ í´ë˜ìŠ¤
class NewsSearcher {
  static PROXIES = [
    url => `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`,
    url => `https://thingproxy.freeboard.io/fetch/${url}`,
    url => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`
  ];
  
  static async fetchWithProxies(url) {
    const errors = [];
    
    for (const proxyFn of this.PROXIES) {
      try {
        const response = await ApiManager.fetchWithTimeout(proxyFn(url));
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        return await response.text();
      } catch (error) {
        errors.push(error.message);
        console.warn('Proxy failed:', error);
      }
    }
    
    throw new Error(`ëª¨ë“  í”„ë¡ì‹œ ì‹¤íŒ¨: ${errors.join(', ')}`);
  }
  
  static async searchGoogleNews(query) {
    const rssUrl = `https://news.google.com/rss/search?q=${encodeURIComponent(query)}&hl=ko&gl=KR&ceid=KR:ko`;
    
    try {
      const response = await ApiManager.fetchWithTimeout(
        `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`
      );
      const data = await response.json();
      
      if (data.status === 'ok') {
        return data.items.map(item => ({
          title: Utils.sanitizeText(item.title),
          link: item.link,
          pubDate: item.pubDate,
          source: 'google',
          score: 1
        }));
      }
    } catch (error) {
      console.warn('RSS2JSON failed, trying direct XML:', error);
    }
    
    try {
      const xml = await this.fetchWithProxies(rssUrl);
      const parser = new DOMParser();
      const doc = parser.parseFromString(xml, 'application/xml');
      
      return Array.from(doc.querySelectorAll('item')).map(item => ({
        title: Utils.sanitizeText(item.querySelector('title')?.textContent || ''),
        link: item.querySelector('link')?.textContent || '',
        pubDate: item.querySelector('pubDate')?.textContent || '',
        source: 'google',
        score: 1
      }));
    } catch (error) {
      console.error('Google News search failed:', error);
      return [];
    }
  }
  
  static async searchNaverNews(query) {
    const naverUrls = [
      'https://rss.news.naver.com/services/news/mainnews.xml',
      'https://rss.news.naver.com/services/news/ranking/popular_day.xml'
    ];
    
    const allItems = [];
    
    for (const url of naverUrls) {
      try {
        const xml = await this.fetchWithProxies(url);
        const parser = new DOMParser();
        const doc = parser.parseFromString(xml, 'application/xml');
        
        const items = Array.from(doc.querySelectorAll('item'))
          .map(item => ({
            title: Utils.sanitizeText(item.querySelector('title')?.textContent || ''),
            link: item.querySelector('link')?.textContent || '',
            pubDate: item.querySelector('pubDate')?.textContent || '',
            source: 'naver',
            score: 3
          }))
          .filter(item => {
            const titleLower = item.title.toLowerCase();
            const queryWords = query.toLowerCase().split(' ');
            return queryWords.some(word => titleLower.includes(word));
          });
        
        allItems.push(...items);
      } catch (error) {
        console.warn('Naver RSS failed:', error);
      }
    }
    
    return allItems;
  }
  
  static calculateSimilarity(str1, str2) {
    const longer = str1.length > str2.length ? str1 : str2;
    const shorter = str1.length > str2.length ? str2 : str1;
    
    if (longer.length === 0) return 1.0;
    
    const editDistance = this.getEditDistance(longer, shorter);
    return (longer.length - editDistance) / longer.length;
  }
  
  static getEditDistance(s1, s2) {
    s1 = s1.toLowerCase();
    s2 = s2.toLowerCase();
    
    const costs = new Array(s2.length + 1);
    
    for (let i = 0; i <= s1.length; i++) {
      let lastValue = i;
      
      for (let j = 0; j <= s2.length; j++) {
        if (i === 0) {
          costs[j] = j;
        } else if (j > 0) {
          let newValue = costs[j - 1];
          if (s1.charAt(i - 1) !== s2.charAt(j - 1)) {
            newValue = Math.min(newValue, lastValue, costs[j]) + 1;
          }
          costs[j - 1] = lastValue;
          lastValue = newValue;
        }
      }
      
      if (i > 0) costs[s2.length] = lastValue;
    }
    
    return costs[s2.length];
  }
  
  static removeDuplicates(items) {
    const unique = [];
    
    for (const item of items) {
      const isDuplicate = unique.some(existing => 
        this.calculateSimilarity(item.title, existing.title) > 0.7
      );
      
      if (!isDuplicate) {
        unique.push(item);
      }
    }
    
    return unique;
  }
  
  static calculateFinalScore(item, query) {
    const timeScore = (Date.now() - new Date(item.pubDate)) / (1000 * 60 * 60);
    const keywords = query.toLowerCase().split(' ');
    const titleLower = item.title.toLowerCase();
    const keywordScore = keywords.reduce((score, keyword) => 
      score + (titleLower.includes(keyword) ? 1 : 0), 0
    );
    
    return item.score + keywordScore * 2 - timeScore * 0.1;
  }
}

// ì½˜í…ì¸  ìƒì„± í´ë˜ìŠ¤
class ContentGenerator {
  static async translateToEnglish(text) {
    try {
      const response = await ApiManager.fetchWithTimeout(
        `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=ko|en`
      );
      const data = await response.json();
      return data.responseData?.translatedText || text;
    } catch (error) {
      console.warn('Translation failed:', error);
      return text;
    }
  }
  
  static createSEOPrompt(articleTitle) {
    return `ë‹¹ì‹ ì€ êµ¬ê¸€ SEO ì „ë¬¸ê°€ì´ì í•œêµ­ì˜ ì¸ê¸° ë¸”ë¡œê±°ì…ë‹ˆë‹¤. Rank Math SEO í”ŒëŸ¬ê·¸ì¸ì—ì„œ 100ì ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ì™„ë²½í•œ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”.

âš ï¸ ì¤‘ìš”: í‚¤ì›Œë“œ ìŠ¤í„°í•‘ì€ ì ˆëŒ€ ê¸ˆì§€ì…ë‹ˆë‹¤. ìì—°ìŠ¤ëŸ¬ìš´ ê¸€ì“°ê¸°ê°€ ìµœìš°ì„ ì…ë‹ˆë‹¤.

ì‘ë‹µì„ JSON ê°ì²´ë¡œë§Œ ë°˜í™˜í•˜ì„¸ìš” (title, meta_description, content, keywords, tags).

## í‚¤ì›Œë“œ ì‚¬ìš© ê·œì¹™ (ë§¤ìš° ì¤‘ìš”)

### ë©”ì¸ í‚¤ì›Œë“œ ì‚¬ìš© ì œí•œ
- ì „ì²´ ê¸€ì—ì„œ ë©”ì¸ í‚¤ì›Œë“œëŠ” ìµœëŒ€ 3-5íšŒë§Œ ì‚¬ìš©
- í‚¤ì›Œë“œ ë°€ë„ 1.5% ì´í•˜ ì—„ê²© ì¤€ìˆ˜
- ê°™ì€ í‚¤ì›Œë“œ ë°˜ë³µ ì‚¬ìš© ì ˆëŒ€ ê¸ˆì§€
- ë™ì˜ì–´, ìœ ì‚¬ì–´, ëŒ€ì²´ í‘œí˜„ì„ ë‹¤ì–‘í•˜ê²Œ í™œìš©

### ìì—°ìŠ¤ëŸ¬ìš´ í‚¤ì›Œë“œ ë°°ì¹˜
-
